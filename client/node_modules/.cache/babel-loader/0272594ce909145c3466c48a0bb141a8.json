{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\KYM\\\\Desktop\\\\calorie\\\\client\\\\src\\\\pages\\\\Profile.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { Helmet } from 'react-helmet-async';\nimport axios from 'axios';\nimport { WEBSITE_NAME } from 'src/utils/brand';\nimport TextInput from 'src/components/forms/TextInput';\nimport RadioButtons from 'src/components/forms/RadioButtons';\nimport AsyncButton from 'src/components/buttons/AsyncButton';\nimport { loadUser } from 'src/actions/auth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst genderOptions = [{\n  id: 'male',\n  label: 'Male'\n}, {\n  id: 'female',\n  label: 'Female'\n}];\n\nconst Profile = ({\n  user: {\n    profile\n  },\n  loadUser\n}) => {\n  _s();\n\n  // We use this ref so we can clear the success message's timeout on component unmounting\n  const messageTimerRef = useRef(null);\n  const [state, setState] = useState({\n    weight: (profile === null || profile === void 0 ? void 0 : profile.weight) || '',\n    height: (profile === null || profile === void 0 ? void 0 : profile.height) || '',\n    age: (profile === null || profile === void 0 ? void 0 : profile.age) || '',\n    gender: (profile === null || profile === void 0 ? void 0 : profile.gender) || 'male',\n    loading: false,\n    errors: [],\n    successMessage: ''\n  });\n  useEffect(() => {\n    // Clearning the timeout\n    return () => {\n      if (messageTimerRef.current) {\n        clearTimeout(messageTimerRef.current);\n      }\n    };\n  }, []);\n\n  const handleOnChange = async e => {\n    setState({ ...state,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleSaveProfile = async e => {\n    e.preventDefault();\n    setState({ ...state,\n      errors: [],\n      loading: true,\n      successMessage: ''\n    });\n    const {\n      weight,\n      height,\n      age,\n      gender\n    } = state;\n    const formData = {\n      weight,\n      height,\n      age,\n      gender\n    };\n\n    try {\n      const res = await axios.put('auth/profile', formData); // We load the user so we get the updated profile\n\n      loadUser();\n      setState(prevState => ({ ...prevState,\n        errors: [],\n        loading: false,\n        successMessage: res.data\n      })); // We also hide the success message after few seconds\n\n      messageTimerRef.current = setTimeout(() => {\n        setState(prevState => ({ ...prevState,\n          successMessage: ''\n        }));\n      }, 6 * 1000);\n    } catch (error) {\n      const {\n        response: {\n          data: {\n            errors\n          }\n        }\n      } = error;\n      setState(prevState => ({ ...prevState,\n        errors,\n        loading: false\n      }));\n    }\n  };\n\n  const {\n    weight,\n    height,\n    age,\n    gender,\n    loading,\n    errors,\n    successMessage\n  } = state;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Helmet, {\n      children: /*#__PURE__*/_jsxDEV(\"title\", {\n        children: `${WEBSITE_NAME} - Profile`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"form-signin\",\n      onSubmit: handleSaveProfile,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"form-title h3 mb-5 font-weight-normal\",\n        children: \"Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TextInput, {\n        name: \"weight\",\n        value: weight,\n        label: \"Weight (Kg)\",\n        type: \"number\",\n        required: true,\n        min: 1,\n        errors: errors,\n        onChange: handleOnChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TextInput, {\n        name: \"height\",\n        value: height,\n        label: \"Height (cm)\",\n        type: \"number\",\n        required: true,\n        min: 1,\n        errors: errors,\n        onChange: handleOnChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TextInput, {\n        name: \"age\",\n        value: age,\n        label: \"Age\",\n        type: \"number\",\n        required: true,\n        min: 1,\n        errors: errors,\n        onChange: handleOnChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(RadioButtons, {\n        name: \"gender\",\n        value: gender,\n        radioOptions: genderOptions,\n        onChange: handleOnChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this), successMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-success mt-3\",\n        role: \"alert\",\n        children: successMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(AsyncButton, {\n        type: \"submit\",\n        text: \"Save\",\n        className: \"primary-button btn-lg rounded-pill mt-4 py-2 px-4\",\n        loading: loading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Profile, \"EcUfu6tmVDysCiGO2bhIX2cx4bw=\");\n\n_c = Profile;\n\nconst mapStateToProps = state => ({\n  user: state.auth.user\n});\n\nProfile.propTypes = {\n  user: PropTypes.object.isRequired,\n  loadUser: PropTypes.func.isRequired\n};\nexport default connect(mapStateToProps, {\n  loadUser\n})(Profile);\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"sources":["C:/Users/KYM/Desktop/calorie/client/src/pages/Profile.js"],"names":["React","useState","useRef","useEffect","PropTypes","connect","Helmet","axios","WEBSITE_NAME","TextInput","RadioButtons","AsyncButton","loadUser","genderOptions","id","label","Profile","user","profile","messageTimerRef","state","setState","weight","height","age","gender","loading","errors","successMessage","current","clearTimeout","handleOnChange","e","target","name","value","handleSaveProfile","preventDefault","formData","res","put","prevState","data","setTimeout","error","response","mapStateToProps","auth","propTypes","object","isRequired","func"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { connect } from 'react-redux';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport axios from 'axios';\r\n\r\nimport { WEBSITE_NAME } from 'src/utils/brand';\r\nimport TextInput from 'src/components/forms/TextInput';\r\nimport RadioButtons from 'src/components/forms/RadioButtons';\r\nimport AsyncButton from 'src/components/buttons/AsyncButton';\r\nimport { loadUser } from 'src/actions/auth';\r\n\r\nconst genderOptions = [\r\n  { id: 'male', label: 'Male' },\r\n  { id: 'female', label: 'Female' },\r\n];\r\n\r\nconst Profile = ({ user: { profile }, loadUser }) => {\r\n  // We use this ref so we can clear the success message's timeout on component unmounting\r\n  const messageTimerRef = useRef(null);\r\n\r\n  const [state, setState] = useState({\r\n    weight: profile?.weight || '',\r\n    height: profile?.height || '',\r\n    age: profile?.age || '',\r\n    gender: profile?.gender || 'male',\r\n    loading: false,\r\n    errors: [],\r\n    successMessage: '',\r\n  });\r\n\r\n  useEffect(() => {\r\n    // Clearning the timeout\r\n    return () => {\r\n      if (messageTimerRef.current) {\r\n        clearTimeout(messageTimerRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const handleOnChange = async (e) => {\r\n    setState({ ...state, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleSaveProfile = async (e) => {\r\n    e.preventDefault();\r\n    setState({ ...state, errors: [], loading: true, successMessage: '' });\r\n    const { weight, height, age, gender } = state;\r\n\r\n    const formData = { weight, height, age, gender };\r\n    try {\r\n      const res = await axios.put('auth/profile', formData);\r\n\r\n      // We load the user so we get the updated profile\r\n      loadUser();\r\n\r\n      setState((prevState) => ({\r\n        ...prevState,\r\n        errors: [],\r\n        loading: false,\r\n        successMessage: res.data,\r\n      }));\r\n\r\n      // We also hide the success message after few seconds\r\n      messageTimerRef.current = setTimeout(() => {\r\n        setState((prevState) => ({\r\n          ...prevState,\r\n          successMessage: '',\r\n        }));\r\n      }, 6 * 1000);\r\n    } catch (error) {\r\n      const {\r\n        response: {\r\n          data: { errors },\r\n        },\r\n      } = error;\r\n      setState((prevState) => ({ ...prevState, errors, loading: false }));\r\n    }\r\n  };\r\n\r\n  const {\r\n    weight,\r\n    height,\r\n    age,\r\n    gender,\r\n    loading,\r\n    errors,\r\n    successMessage,\r\n  } = state;\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{`${WEBSITE_NAME} - Profile`}</title>\r\n      </Helmet>\r\n      <form className=\"form-signin\" onSubmit={handleSaveProfile}>\r\n        <h1 className=\"form-title h3 mb-5 font-weight-normal\">Profile</h1>\r\n        <TextInput\r\n          name=\"weight\"\r\n          value={weight}\r\n          label=\"Weight (Kg)\"\r\n          type=\"number\"\r\n          required\r\n          min={1}\r\n          errors={errors}\r\n          onChange={handleOnChange}\r\n        />\r\n        <TextInput\r\n          name=\"height\"\r\n          value={height}\r\n          label=\"Height (cm)\"\r\n          type=\"number\"\r\n          required\r\n          min={1}\r\n          errors={errors}\r\n          onChange={handleOnChange}\r\n        />\r\n        <TextInput\r\n          name=\"age\"\r\n          value={age}\r\n          label=\"Age\"\r\n          type=\"number\"\r\n          required\r\n          min={1}\r\n          errors={errors}\r\n          onChange={handleOnChange}\r\n        />\r\n\r\n        <RadioButtons\r\n          name=\"gender\"\r\n          value={gender}\r\n          radioOptions={genderOptions}\r\n          onChange={handleOnChange}\r\n        />\r\n\r\n        {successMessage && (\r\n          <div className=\"alert alert-success mt-3\" role=\"alert\">\r\n            {successMessage}\r\n          </div>\r\n        )}\r\n\r\n        <AsyncButton\r\n          type=\"submit\"\r\n          text=\"Save\"\r\n          className=\"primary-button btn-lg rounded-pill mt-4 py-2 px-4\"\r\n          loading={loading}\r\n        />\r\n      </form>\r\n    </>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n  user: state.auth.user,\r\n});\r\n\r\nProfile.propTypes = {\r\n  user: PropTypes.object.isRequired,\r\n  loadUser: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default connect(mapStateToProps, { loadUser })(Profile);\r\n"]},"metadata":{},"sourceType":"module"}