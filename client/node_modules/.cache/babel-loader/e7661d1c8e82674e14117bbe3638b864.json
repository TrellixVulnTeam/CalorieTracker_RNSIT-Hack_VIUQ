{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\KYM\\\\Desktop\\\\calorie\\\\client\\\\src\\\\components\\\\my-foods\\\\AddFood.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport axios from 'axios';\nimport ActionModal from 'src/components/modals/ActionModal';\nimport TextInput from 'src/components/forms/TextInput';\nimport FileInput from 'src/components/forms/FileInput';\nimport AsyncButton from 'src/components/buttons/AsyncButton';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst AddFood = ({\n  modalRef,\n  handleClose,\n  handleGetFoods\n}) => {\n  _s();\n\n  // We use the ref so we can reset the value of the file input since it is not a controlled component\n  const imageInputRef = useRef(); // We use this ref so we can clear the success message's timeout on component unmounting\n\n  const messageTimerRef = useRef(null);\n  const [state, setState] = useState({\n    name: '',\n    caloriesPerPortion: '',\n    image: null,\n    loading: false,\n    errors: [],\n    successMessage: ''\n  });\n  useEffect(() => {\n    // Clearning the timeout\n    return () => {\n      if (messageTimerRef.current) {\n        clearTimeout(messageTimerRef.current);\n      }\n    };\n  }, []);\n\n  const handleOnChange = e => {\n    setState({ ...state,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleSetImage = image => {\n    setState({ ...state,\n      image\n    });\n  };\n\n  const handleEmptyImage = () => {\n    imageInputRef.current.value = '';\n    setState({ ...state,\n      image: null\n    });\n  };\n\n  const handleAddFood = async e => {\n    e.preventDefault();\n    setState({ ...state,\n      loading: true,\n      errors: []\n    });\n    const {\n      name,\n      caloriesPerPortion,\n      image\n    } = state; // Creating a FormData object so we can append the image file to it\n\n    const formData = new FormData();\n    formData.append('name', name);\n    formData.append('caloriesPerPortion', caloriesPerPortion);\n\n    if (image) {\n      formData.append('image', image, image.name);\n    }\n\n    try {\n      const res = await axios.post('foods', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }); // We empty the the fields after a successfull add\n\n      setState(prevState => ({ ...prevState,\n        loading: false,\n        name: '',\n        caloriesPerPortion: '',\n        image: null,\n        successMessage: res.data\n      }));\n      imageInputRef.current.value = '';\n      handleGetFoods(); // We also hide the success message after few seconds\n\n      messageTimerRef.current = setTimeout(() => {\n        setState(prevState => ({ ...prevState,\n          successMessage: ''\n        }));\n      }, 6 * 1000);\n    } catch (error) {\n      const {\n        response: {\n          data: {\n            errors\n          }\n        }\n      } = error;\n      setState(prevState => ({ ...prevState,\n        errors,\n        loading: false\n      }));\n    }\n  };\n\n  const {\n    name,\n    caloriesPerPortion,\n    image,\n    loading,\n    successMessage,\n    errors\n  } = state;\n  return /*#__PURE__*/_jsxDEV(ActionModal, {\n    modalRef: modalRef,\n    title: \"Add Food\",\n    handleClose: handleClose,\n    actions: /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"primary-button btn-lg rounded-pill ms-0 ms-sm-4\",\n        type: \"button\",\n        disabled: !image,\n        onClick: handleEmptyImage,\n        children: \"Empty Image\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(AsyncButton, {\n        type: \"submit\",\n        text: \"Add\",\n        className: \"primary-button btn-lg rounded-pill ms-0 ms-sm-4\",\n        loading: loading,\n        disabled: !name || !caloriesPerPortion,\n        form: \"add-food-form\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true),\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"px-5\",\n      id: \"add-food-form\",\n      onSubmit: handleAddFood,\n      children: [/*#__PURE__*/_jsxDEV(TextInput, {\n        name: \"name\",\n        value: name,\n        label: \"Name*\",\n        type: \"text\",\n        required: true,\n        min: 1,\n        errors: errors,\n        onChange: handleOnChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(TextInput, {\n        name: \"caloriesPerPortion\",\n        value: caloriesPerPortion,\n        label: \"Calories per portion*\",\n        type: \"number\",\n        required: true,\n        min: 1,\n        errors: errors,\n        onChange: handleOnChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FileInput, {\n        name: \"image\",\n        label: \"Upload an image\",\n        handleChange: handleSetImage,\n        reference: imageInputRef,\n        errors: errors,\n        accept: \"image/png, image/jpg, image/jpeg\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 9\n      }, this), successMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert alert-success\",\n        role: \"alert\",\n        children: successMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AddFood, \"4TiMfGTpos/kjLEWDDVZ+znTzmM=\");\n\n_c = AddFood;\nAddFood.propTypes = {\n  modalRef: PropTypes.object.isRequired,\n  handleClose: PropTypes.func.isRequired,\n  handleGetFoods: PropTypes.func.isRequired\n};\nexport default AddFood;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddFood\");","map":{"version":3,"sources":["C:/Users/KYM/Desktop/calorie/client/src/components/my-foods/AddFood.js"],"names":["React","useState","useRef","useEffect","PropTypes","axios","ActionModal","TextInput","FileInput","AsyncButton","AddFood","modalRef","handleClose","handleGetFoods","imageInputRef","messageTimerRef","state","setState","name","caloriesPerPortion","image","loading","errors","successMessage","current","clearTimeout","handleOnChange","e","target","value","handleSetImage","handleEmptyImage","handleAddFood","preventDefault","formData","FormData","append","res","post","headers","prevState","data","setTimeout","error","response","propTypes","object","isRequired","func"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport axios from 'axios';\r\n\r\nimport ActionModal from 'src/components/modals/ActionModal';\r\nimport TextInput from 'src/components/forms/TextInput';\r\nimport FileInput from 'src/components/forms/FileInput';\r\nimport AsyncButton from 'src/components/buttons/AsyncButton';\r\n\r\nconst AddFood = ({ modalRef, handleClose, handleGetFoods }) => {\r\n  // We use the ref so we can reset the value of the file input since it is not a controlled component\r\n  const imageInputRef = useRef();\r\n\r\n  // We use this ref so we can clear the success message's timeout on component unmounting\r\n  const messageTimerRef = useRef(null);\r\n\r\n  const [state, setState] = useState({\r\n    name: '',\r\n    caloriesPerPortion: '',\r\n    image: null,\r\n    loading: false,\r\n    errors: [],\r\n    successMessage: '',\r\n  });\r\n\r\n  useEffect(() => {\r\n    // Clearning the timeout\r\n    return () => {\r\n      if (messageTimerRef.current) {\r\n        clearTimeout(messageTimerRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const handleOnChange = (e) => {\r\n    setState({ ...state, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleSetImage = (image) => {\r\n    setState({ ...state, image });\r\n  };\r\n\r\n  const handleEmptyImage = () => {\r\n    imageInputRef.current.value = '';\r\n    setState({ ...state, image: null });\r\n  };\r\n\r\n  const handleAddFood = async (e) => {\r\n    e.preventDefault();\r\n    setState({ ...state, loading: true, errors: [] });\r\n    const { name, caloriesPerPortion, image } = state;\r\n\r\n    // Creating a FormData object so we can append the image file to it\r\n    const formData = new FormData();\r\n\r\n    formData.append('name', name);\r\n    formData.append('caloriesPerPortion', caloriesPerPortion);\r\n    if (image) {\r\n      formData.append('image', image, image.name);\r\n    }\r\n\r\n    try {\r\n      const res = await axios.post('foods', formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data',\r\n        },\r\n      });\r\n\r\n      // We empty the the fields after a successfull add\r\n      setState((prevState) => ({\r\n        ...prevState,\r\n        loading: false,\r\n        name: '',\r\n        caloriesPerPortion: '',\r\n        image: null,\r\n        successMessage: res.data,\r\n      }));\r\n      imageInputRef.current.value = '';\r\n\r\n      handleGetFoods();\r\n\r\n      // We also hide the success message after few seconds\r\n      messageTimerRef.current = setTimeout(() => {\r\n        setState((prevState) => ({\r\n          ...prevState,\r\n          successMessage: '',\r\n        }));\r\n      }, 6 * 1000);\r\n    } catch (error) {\r\n      const {\r\n        response: {\r\n          data: { errors },\r\n        },\r\n      } = error;\r\n      setState((prevState) => ({ ...prevState, errors, loading: false }));\r\n    }\r\n  };\r\n\r\n  const {\r\n    name,\r\n    caloriesPerPortion,\r\n    image,\r\n    loading,\r\n    successMessage,\r\n    errors,\r\n  } = state;\r\n\r\n  return (\r\n    <ActionModal\r\n      modalRef={modalRef}\r\n      title=\"Add Food\"\r\n      handleClose={handleClose}\r\n      actions={\r\n        <>\r\n          <button\r\n            className=\"primary-button btn-lg rounded-pill ms-0 ms-sm-4\"\r\n            type=\"button\"\r\n            disabled={!image}\r\n            onClick={handleEmptyImage}\r\n          >\r\n            Empty Image\r\n          </button>\r\n          <AsyncButton\r\n            type=\"submit\"\r\n            text=\"Add\"\r\n            className=\"primary-button btn-lg rounded-pill ms-0 ms-sm-4\"\r\n            loading={loading}\r\n            disabled={!name || !caloriesPerPortion}\r\n            form=\"add-food-form\"\r\n          />\r\n        </>\r\n      }\r\n    >\r\n      <form className=\"px-5\" id=\"add-food-form\" onSubmit={handleAddFood}>\r\n        <TextInput\r\n          name=\"name\"\r\n          value={name}\r\n          label=\"Name*\"\r\n          type=\"text\"\r\n          required\r\n          min={1}\r\n          errors={errors}\r\n          onChange={handleOnChange}\r\n        />\r\n        <TextInput\r\n          name=\"caloriesPerPortion\"\r\n          value={caloriesPerPortion}\r\n          label=\"Calories per portion*\"\r\n          type=\"number\"\r\n          required\r\n          min={1}\r\n          errors={errors}\r\n          onChange={handleOnChange}\r\n        />\r\n\r\n        <FileInput\r\n          name=\"image\"\r\n          label=\"Upload an image\"\r\n          handleChange={handleSetImage}\r\n          reference={imageInputRef}\r\n          errors={errors}\r\n          accept=\"image/png, image/jpg, image/jpeg\"\r\n        />\r\n\r\n        {successMessage && (\r\n          <div className=\"alert alert-success\" role=\"alert\">\r\n            {successMessage}\r\n          </div>\r\n        )}\r\n      </form>\r\n    </ActionModal>\r\n  );\r\n};\r\n\r\nAddFood.propTypes = {\r\n  modalRef: PropTypes.object.isRequired,\r\n  handleClose: PropTypes.func.isRequired,\r\n  handleGetFoods: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default AddFood;\r\n"]},"metadata":{},"sourceType":"module"}